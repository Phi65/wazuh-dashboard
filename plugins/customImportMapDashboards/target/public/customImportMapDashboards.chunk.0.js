(window["customImportMapDashboards_bundle_jsonpfunction"]=window["customImportMapDashboards_bundle_jsonpfunction"]||[]).push([[0],{1062:function(module,exports,__webpack_require__){"use strict";var _interopRequireDefault=__webpack_require__(0);var _typeof3=__webpack_require__(8);Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _regenerator=_interopRequireDefault(__webpack_require__(14));var _extends2=_interopRequireDefault(__webpack_require__(32));var _typeof2=_interopRequireDefault(__webpack_require__(8));var _toConsumableArray2=_interopRequireDefault(__webpack_require__(19));var _asyncToGenerator2=_interopRequireDefault(__webpack_require__(15));var _classCallCheck2=_interopRequireDefault(__webpack_require__(3));var _createClass2=_interopRequireDefault(__webpack_require__(4));var _assertThisInitialized2=_interopRequireDefault(__webpack_require__(16));var _inherits2=_interopRequireDefault(__webpack_require__(11));var _possibleConstructorReturn2=_interopRequireDefault(__webpack_require__(12));var _getPrototypeOf2=_interopRequireDefault(__webpack_require__(9));var _defineProperty2=_interopRequireDefault(__webpack_require__(1));var _react=_interopRequireWildcard(__webpack_require__(5));var _i18n=__webpack_require__(2);var _classnames=_interopRequireDefault(__webpack_require__(44));var _eui=__webpack_require__(13);var _react2=__webpack_require__(27);var _lodash=__webpack_require__(7);var _autocomplete=__webpack_require__(135);var _public=__webpack_require__(24);var _fetch_index_patterns=__webpack_require__(1296);var _language_switcher=__webpack_require__(1297);var _query=__webpack_require__(134);var _=__webpack_require__(329);function _getRequireWildcardCache(nodeInterop){if(typeof WeakMap!=="function")return null;var cacheBabelInterop=new WeakMap;var cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function _getRequireWildcardCache(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule){return obj}if(obj===null||_typeof3(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(key!=="default"&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){(0,_defineProperty2.default)(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=(0,_getPrototypeOf2.default)(Derived),result;if(hasNativeReflectConstruct){var NewTarget=(0,_getPrototypeOf2.default)(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return(0,_possibleConstructorReturn2.default)(this,result)}}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));return true}catch(e){return false}}var KEY_CODES={LEFT:37,UP:38,RIGHT:39,DOWN:40,ENTER:13,ESC:27,TAB:9,HOME:36,END:35};var QueryStringInputUI=function(_Component){(0,_inherits2.default)(QueryStringInputUI,_Component);var _super=_createSuper(QueryStringInputUI);function QueryStringInputUI(){var _this;(0,_classCallCheck2.default)(this,QueryStringInputUI);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_this=_super.call.apply(_super,[this].concat(args));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"state",{isSuggestionsVisible:false,index:null,suggestions:[],suggestionLimit:50,selectionStart:null,selectionEnd:null,indexPatterns:[],queryBarRect:undefined});(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"inputRef",null);(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"persistedLog",void 0);(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"abortController",void 0);(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"services",_this.props.opensearchDashboards.services);(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"componentIsUnmounting",false);(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"queryBarInputDivRefInstance",(0,_react.createRef)());(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"getQueryString",(function(){return(0,_query.toUser)(_this.props.query.query)}));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"fetchIndexPatterns",(0,_asyncToGenerator2.default)(_regenerator.default.mark((function _callee(){var stringPatterns,objectPatterns,objectPatternsFromStrings;return _regenerator.default.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:stringPatterns=_this.props.indexPatterns.filter((function(indexPattern){return typeof indexPattern==="string"}));objectPatterns=_this.props.indexPatterns.filter((function(indexPattern){return typeof indexPattern!=="string"}));_context.next=4;return(0,_fetch_index_patterns.fetchIndexPatterns)(_this.services.savedObjects.client,stringPatterns,_this.services.uiSettings);case 4:objectPatternsFromStrings=_context.sent;_this.setState({indexPatterns:[].concat((0,_toConsumableArray2.default)(objectPatterns),(0,_toConsumableArray2.default)(objectPatternsFromStrings))});case 6:case"end":return _context.stop()}}}),_callee)}))));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"getSuggestions",(0,_asyncToGenerator2.default)(_regenerator.default.mark((function _callee2(){var language,queryString,recentSearchSuggestions,hasQuerySuggestions,indexPatterns,_this$inputRef,selectionStart,selectionEnd,suggestions;return _regenerator.default.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(_this.inputRef){_context2.next=2;break}return _context2.abrupt("return");case 2:language=_this.props.query.language;queryString=_this.getQueryString();recentSearchSuggestions=_this.getRecentSearchSuggestions(queryString);hasQuerySuggestions=_this.services.data.autocomplete.hasQuerySuggestions(language);if(!(!hasQuerySuggestions||!Array.isArray(_this.state.indexPatterns)||(0,_lodash.compact)(_this.state.indexPatterns).length===0)){_context2.next=8;break}return _context2.abrupt("return",recentSearchSuggestions);case 8:indexPatterns=_this.state.indexPatterns;_this$inputRef=_this.inputRef,selectionStart=_this$inputRef.selectionStart,selectionEnd=_this$inputRef.selectionEnd;if(!(selectionStart===null||selectionEnd===null)){_context2.next=12;break}return _context2.abrupt("return");case 12:_context2.prev=12;if(_this.abortController)_this.abortController.abort();_this.abortController=new AbortController;_context2.next=17;return _this.services.data.autocomplete.getQuerySuggestions({language:language,indexPatterns:indexPatterns,query:queryString,selectionStart:selectionStart,selectionEnd:selectionEnd,signal:_this.abortController.signal});case 17:_context2.t0=_context2.sent;if(_context2.t0){_context2.next=20;break}_context2.t0=[];case 20:suggestions=_context2.t0;return _context2.abrupt("return",[].concat((0,_toConsumableArray2.default)(suggestions),(0,_toConsumableArray2.default)(recentSearchSuggestions)));case 24:_context2.prev=24;_context2.t1=_context2["catch"](12);if(!(_context2.t1.message==="The user aborted a request.")){_context2.next=28;break}return _context2.abrupt("return");case 28:throw _context2.t1;case 29:case"end":return _context2.stop()}}}),_callee2,null,[[12,24]])}))));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"getRecentSearchSuggestions",(function(query){if(!_this.persistedLog){return[]}var recentSearches=_this.persistedLog.get();var matchingRecentSearches=recentSearches.filter((function(recentQuery){var recentQueryString=(0,_typeof2.default)(recentQuery)==="object"?(0,_query.toUser)(recentQuery):recentQuery;return recentQueryString.includes(query)}));return matchingRecentSearches.map((function(recentSearch){var text=(0,_query.toUser)(recentSearch);var start=0;var end=query.length;return{type:_autocomplete.QuerySuggestionTypes.RecentSearch,text:text,start:start,end:end}}))}));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"updateSuggestions",(0,_lodash.debounce)((0,_asyncToGenerator2.default)(_regenerator.default.mark((function _callee3(){var suggestions;return _regenerator.default.wrap((function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return _this.getSuggestions();case 2:_context3.t0=_context3.sent;if(_context3.t0){_context3.next=5;break}_context3.t0=[];case 5:suggestions=_context3.t0;if(!_this.componentIsUnmounting){_this.setState({suggestions:suggestions})}case 7:case"end":return _context3.stop()}}}),_callee3)}))),100));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"onSubmit",(function(query){if(_this.props.onSubmit){if(_this.persistedLog){_this.persistedLog.add(query.query)}_this.props.onSubmit({query:(0,_query.fromUser)(query.query),language:query.language})}}));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"onChange",(function(query){_this.updateSuggestions();if(_this.props.onChange){_this.props.onChange({query:(0,_query.fromUser)(query.query),language:query.language})}}));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"onQueryStringChange",(function(value){_this.setState({isSuggestionsVisible:true,index:null,suggestionLimit:50});_this.onChange({query:value,language:_this.props.query.language})}));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"onInputChange",(function(event){_this.onQueryStringChange(event.target.value);if(event.target.value===""){_this.handleRemoveHeight()}else{_this.handleAutoHeight()}}));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"onClickInput",(function(event){if(event.target instanceof HTMLTextAreaElement){_this.onQueryStringChange(event.target.value)}}));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"onKeyUp",(function(event){if([KEY_CODES.LEFT,KEY_CODES.RIGHT,KEY_CODES.HOME,KEY_CODES.END].includes(event.keyCode)){_this.setState({isSuggestionsVisible:true});if(event.target instanceof HTMLTextAreaElement){_this.onQueryStringChange(event.target.value)}}}));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"onKeyDown",(function(event){if(event.target instanceof HTMLTextAreaElement){var _this$state=_this.state,isSuggestionsVisible=_this$state.isSuggestionsVisible,index=_this$state.index;var preventDefault=event.preventDefault.bind(event);var target=event.target,key=event.key,metaKey=event.metaKey;var value=target.value,selectionStart=target.selectionStart,selectionEnd=target.selectionEnd;var updateQuery=function updateQuery(query,newSelectionStart,newSelectionEnd){_this.onQueryStringChange(query);_this.setState({selectionStart:newSelectionStart,selectionEnd:newSelectionEnd})};switch(event.keyCode){case KEY_CODES.DOWN:if(isSuggestionsVisible&&index!==null){event.preventDefault();_this.incrementIndex(index)}else if(isSuggestionsVisible&&index==null||_this.getQueryString()===""){event.preventDefault();_this.setState({isSuggestionsVisible:true,index:0})}break;case KEY_CODES.UP:if(isSuggestionsVisible&&index!==null){event.preventDefault();_this.decrementIndex(index)}break;case KEY_CODES.ENTER:if(!_this.props.bubbleSubmitEvent){event.preventDefault()}if(isSuggestionsVisible&&index!==null&&_this.state.suggestions[index]){event.preventDefault();_this.selectSuggestion(_this.state.suggestions[index])}else{_this.onSubmit(_this.props.query);_this.setState({isSuggestionsVisible:false})}break;case KEY_CODES.ESC:event.preventDefault();_this.setState({isSuggestionsVisible:false,index:null});break;case KEY_CODES.TAB:_this.setState({isSuggestionsVisible:false,index:null});break;default:if(selectionStart!==null&&selectionEnd!==null){(0,_query.matchPairs)({value:value,selectionStart:selectionStart,selectionEnd:selectionEnd,key:key,metaKey:metaKey,updateQuery:updateQuery,preventDefault:preventDefault})}break}}}));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"selectSuggestion",(function(suggestion){if(!_this.inputRef){return}var type=suggestion.type,text=suggestion.text,start=suggestion.start,end=suggestion.end,cursorIndex=suggestion.cursorIndex;_this.handleNestedFieldSyntaxNotification(suggestion);var query=_this.getQueryString();var _this$inputRef2=_this.inputRef,selectionStart=_this$inputRef2.selectionStart,selectionEnd=_this$inputRef2.selectionEnd;if(selectionStart===null||selectionEnd===null){return}var value=query.substr(0,selectionStart)+query.substr(selectionEnd);var newQueryString=value.substr(0,start)+text+value.substr(end);_this.onQueryStringChange(newQueryString);_this.setState({selectionStart:start+(cursorIndex?cursorIndex:text.length),selectionEnd:start+(cursorIndex?cursorIndex:text.length)});if(type===_autocomplete.QuerySuggestionTypes.RecentSearch){_this.setState({isSuggestionsVisible:false,index:null});_this.onSubmit({query:newQueryString,language:_this.props.query.language})}}));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"handleNestedFieldSyntaxNotification",(function(suggestion){if("field"in suggestion&&suggestion.field.subType&&suggestion.field.subType.nested&&!_this.services.storage.get("opensearchDashboards.DQLNestedQuerySyntaxInfoOptOut")){var _this$services=_this.services,notifications=_this$services.notifications,docLinks=_this$services.docLinks;var onDQLNestedQuerySyntaxInfoOptOut=function onDQLNestedQuerySyntaxInfoOptOut(toast){if(!_this.services.storage)return;_this.services.storage.set("opensearchDashboards.DQLNestedQuerySyntaxInfoOptOut",true);notifications.toasts.remove(toast)};if(notifications&&docLinks){var toast=notifications.toasts.add({title:_i18n.i18n.translate("data.query.queryBar.DQLNestedQuerySyntaxInfoTitle",{defaultMessage:"DQL nested query syntax"}),text:(0,_public.toMountPoint)(_react.default.createElement("div",null,_react.default.createElement("p",null,_react.default.createElement(_react2.FormattedMessage,{id:"data.query.queryBar.DQLNestedQuerySyntaxInfoText",defaultMessage:"It looks like you're querying on a nested field. You can construct DQL syntax for nested queries in different ways, depending on the results you want. Learn more in our {link}.",values:{link:_react.default.createElement(_eui.EuiLink,{href:docLinks.links.opensearchDashboards.dql.base,target:"_blank"},_react.default.createElement(_react2.FormattedMessage,{id:"data.query.queryBar.DQLNestedQuerySyntaxInfoDocLinkText",defaultMessage:"docs"}))}})),_react.default.createElement(_eui.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},_react.default.createElement(_eui.EuiFlexItem,{grow:false},_react.default.createElement(_eui.EuiButton,{size:"s",onClick:function onClick(){return onDQLNestedQuerySyntaxInfoOptOut(toast)}},_react.default.createElement(_react2.FormattedMessage,{id:"data.query.queryBar.DQLNestedQuerySyntaxInfoOptOutText",defaultMessage:"Don't show again"}))))))})}}}));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"increaseLimit",(function(){_this.setState({suggestionLimit:_this.state.suggestionLimit+50})}));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"incrementIndex",(function(currentIndex){var nextIndex=currentIndex+1;if(currentIndex===null||nextIndex>=_this.state.suggestions.length){nextIndex=0}_this.setState({index:nextIndex})}));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"decrementIndex",(function(currentIndex){var previousIndex=currentIndex-1;if(previousIndex<0){_this.setState({index:_this.state.suggestions.length-1})}else{_this.setState({index:previousIndex})}}));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"onSelectLanguage",(function(language){_this.services.http.post("/api/opensearch-dashboards/dql_opt_in_stats",{body:JSON.stringify({opt_in:language==="kuery"})});_this.services.storage.set("opensearchDashboards.userQueryLanguage",language);var newQuery={query:"",language:language};_this.onChange(newQuery);_this.onSubmit(newQuery)}));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"onOutsideClick",(function(){if(_this.state.isSuggestionsVisible){_this.setState({isSuggestionsVisible:false,index:null})}_this.handleBlurHeight();if(_this.props.onChangeQueryInputFocus){_this.props.onChangeQueryInputFocus(false)}}));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"onInputBlur",(function(){_this.handleBlurHeight();if(_this.props.onChangeQueryInputFocus){_this.props.onChangeQueryInputFocus(false)}if((0,_lodash.isFunction)(_this.props.onBlur)){_this.props.onBlur()}}));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"onClickSuggestion",(function(suggestion){if(!_this.inputRef){return}_this.selectSuggestion(suggestion);_this.inputRef.focus()}));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"initPersistedLog",(function(){var _this$services2=_this.services,uiSettings=_this$services2.uiSettings,storage=_this$services2.storage,appName=_this$services2.appName;_this.persistedLog=_this.props.persistedLog?_this.props.persistedLog:(0,_query.getQueryLog)(uiSettings,storage,appName,_this.props.query.language)}));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"onMouseEnterSuggestion",(function(index){_this.setState({index:index})}));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"textareaId",(0,_eui.htmlIdGenerator)()());(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"handleListUpdate",(function(){var _this$queryBarInputDi;if(_this.componentIsUnmounting)return;return _this.setState({queryBarRect:(_this$queryBarInputDi=_this.queryBarInputDivRefInstance.current)===null||_this$queryBarInputDi===void 0?void 0:_this$queryBarInputDi.getBoundingClientRect()})}));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"handleAutoHeight",(function(){if(_this.inputRef!==null&&document.activeElement===_this.inputRef){_this.inputRef.style.setProperty("height","".concat(_this.inputRef.scrollHeight,"px"),"important")}_this.handleListUpdate()}));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"handleRemoveHeight",(function(){if(_this.inputRef!==null){_this.inputRef.style.removeProperty("height")}}));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"handleBlurHeight",(function(){if(_this.inputRef!==null){_this.handleRemoveHeight();_this.inputRef.scrollTop=0}}));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"handleOnFocus",(function(){if(_this.props.onChangeQueryInputFocus){_this.props.onChangeQueryInputFocus(true)}requestAnimationFrame((function(){_this.handleAutoHeight()}))}));return _this}(0,_createClass2.default)(QueryStringInputUI,[{key:"componentDidMount",value:function componentDidMount(){var parsedQuery=(0,_query.fromUser)((0,_query.toUser)(this.props.query.query));if(!(0,_lodash.isEqual)(this.props.query.query,parsedQuery)){this.onChange(_objectSpread(_objectSpread({},this.props.query),{},{query:parsedQuery}))}this.initPersistedLog();this.fetchIndexPatterns().then(this.updateSuggestions);this.handleListUpdate();window.addEventListener("resize",this.handleAutoHeight);window.addEventListener("scroll",this.handleListUpdate,{passive:true,capture:true})}},{key:"componentDidUpdate",value:function componentDidUpdate(prevProps){var parsedQuery=(0,_query.fromUser)((0,_query.toUser)(this.props.query.query));if(!(0,_lodash.isEqual)(this.props.query.query,parsedQuery)){this.onChange(_objectSpread(_objectSpread({},this.props.query),{},{query:parsedQuery}))}this.initPersistedLog();if(!(0,_lodash.isEqual)(prevProps.indexPatterns,this.props.indexPatterns)){this.fetchIndexPatterns().then(this.updateSuggestions)}else if(!(0,_lodash.isEqual)(prevProps.query,this.props.query)){this.updateSuggestions()}if(this.state.selectionStart!==null&&this.state.selectionEnd!==null){if(this.inputRef!=null){this.inputRef.setSelectionRange(this.state.selectionStart,this.state.selectionEnd)}this.setState({selectionStart:null,selectionEnd:null});if(document.activeElement!==null&&document.activeElement.id===this.textareaId){this.handleAutoHeight()}else{this.handleRemoveHeight()}}}},{key:"componentWillUnmount",value:function componentWillUnmount(){if(this.abortController)this.abortController.abort();if(this.updateSuggestions.cancel)this.updateSuggestions.cancel();this.componentIsUnmounting=true;window.removeEventListener("resize",this.handleAutoHeight);window.removeEventListener("scroll",this.handleListUpdate,{capture:true})}},{key:"render",value:function render(){var _this2=this;var isSuggestionsVisible=this.state.isSuggestionsVisible&&{"aria-controls":"osdTypeahead__items","aria-owns":"osdTypeahead__items"};var ariaCombobox=_objectSpread(_objectSpread({},isSuggestionsVisible),{},{role:"combobox"});var className=(0,_classnames.default)("euiFormControlLayout euiFormControlLayout--group osdQueryBar__wrap",this.props.className);return _react.default.createElement("div",{className:className},this.props.prepend,_react.default.createElement(_eui.EuiOutsideClickDetector,{onOutsideClick:this.onOutsideClick},_react.default.createElement("div",(0,_extends2.default)({},ariaCombobox,{style:{position:"relative",width:"100%"},"aria-label":_i18n.i18n.translate("data.query.queryBar.comboboxAriaLabel",{defaultMessage:"Search and filter the {pageType} page",values:{pageType:this.services.appName}}),"aria-haspopup":"true","aria-expanded":this.state.isSuggestionsVisible,"data-skip-axe":"aria-required-children"}),_react.default.createElement("div",{role:"search",className:"euiFormControlLayout__childrenWrapper osdQueryBar__textareaWrap",ref:this.queryBarInputDivRefInstance},_react.default.createElement(_eui.EuiTextArea,{placeholder:this.props.placeholder||_i18n.i18n.translate("data.query.queryBar.searchInputPlaceholder",{defaultMessage:"Search"}),value:this.getQueryString(),onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,onChange:this.onInputChange,onClick:this.onClickInput,onBlur:this.onInputBlur,onFocus:this.handleOnFocus,className:"osdQueryBar__textarea",fullWidth:true,rows:1,id:this.textareaId,autoFocus:this.props.onChangeQueryInputFocus?false:!this.props.disableAutoFocus,inputRef:function inputRef(node){if(node){_this2.inputRef=node}},autoComplete:"off",spellCheck:false,"aria-label":_i18n.i18n.translate("data.query.queryBar.searchInputAriaLabel",{defaultMessage:"Start typing to search and filter the {pageType} page",values:{pageType:this.services.appName}}),"aria-autocomplete":"list","aria-controls":this.state.isSuggestionsVisible?"osdTypeahead__items":undefined,"aria-activedescendant":this.state.isSuggestionsVisible&&typeof this.state.index==="number"?"suggestion-".concat(this.state.index):undefined,role:"textbox","data-test-subj":this.props.dataTestSubj||"queryInput",isInvalid:this.props.isInvalid},this.getQueryString())),_react.default.createElement(_eui.EuiPortal,null,_react.default.createElement(_.SuggestionsComponent,{show:this.state.isSuggestionsVisible,suggestions:this.state.suggestions.slice(0,this.state.suggestionLimit),index:this.state.index,onClick:this.onClickSuggestion,onMouseEnter:this.onMouseEnterSuggestion,loadMore:this.increaseLimit,queryBarRect:this.state.queryBarRect,size:this.props.size})))),_react.default.createElement(_language_switcher.QueryLanguageSwitcher,{language:this.props.query.language,anchorPosition:this.props.languageSwitcherPopoverAnchorPosition,onSelectLanguage:this.onSelectLanguage}))}}]);return QueryStringInputUI}(_react.Component);exports.default=QueryStringInputUI;module.exports=exports.default},1296:function(module,exports,__webpack_require__){"use strict";var _interopRequireDefault=__webpack_require__(0);Object.defineProperty(exports,"__esModule",{value:true});exports.fetchIndexPatterns=fetchIndexPatterns;var _regenerator=_interopRequireDefault(__webpack_require__(14));var _toConsumableArray2=_interopRequireDefault(__webpack_require__(19));var _asyncToGenerator2=_interopRequireDefault(__webpack_require__(15));var _lodash=__webpack_require__(7);var _=__webpack_require__(55);function fetchIndexPatterns(_x,_x2,_x3){return _fetchIndexPatterns.apply(this,arguments)}function _fetchIndexPatterns(){_fetchIndexPatterns=(0,_asyncToGenerator2.default)(_regenerator.default.mark((function _callee(savedObjectsClient,indexPatternStrings,uiSettings){var searchString,indexPatternsFromSavedObjects,exactMatches,defaultIndex,allMatches;return _regenerator.default.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(!indexPatternStrings||(0,_lodash.isEmpty)(indexPatternStrings))){_context.next=2;break}return _context.abrupt("return",[]);case 2:searchString=indexPatternStrings.map((function(string){return'"'.concat(string,'"')})).join(" | ");_context.next=5;return savedObjectsClient.find({type:"index-pattern",fields:["title","fields"],search:searchString,searchFields:["title"]});case 5:indexPatternsFromSavedObjects=_context.sent;exactMatches=indexPatternsFromSavedObjects.savedObjects.filter((function(savedObject){return indexPatternStrings.includes(savedObject.attributes.title)}));defaultIndex=uiSettings.get("defaultIndex");if(!(exactMatches.length===indexPatternStrings.length)){_context.next=12;break}_context.t0=exactMatches;_context.next=19;break;case 12:_context.t1=[];_context.t2=(0,_toConsumableArray2.default)(exactMatches);_context.next=16;return savedObjectsClient.get("index-pattern",defaultIndex);case 16:_context.t3=_context.sent;_context.t4=[_context.t3];_context.t0=_context.t1.concat.call(_context.t1,_context.t2,_context.t4);case 19:allMatches=_context.t0;return _context.abrupt("return",allMatches.map(_.indexPatterns.getFromSavedObject));case 21:case"end":return _context.stop()}}}),_callee)})));return _fetchIndexPatterns.apply(this,arguments)}},1297:function(module,exports,__webpack_require__){"use strict";var _interopRequireDefault=__webpack_require__(0);var _typeof=__webpack_require__(8);Object.defineProperty(exports,"__esModule",{value:true});exports.QueryLanguageSwitcher=QueryLanguageSwitcher;var _slicedToArray2=_interopRequireDefault(__webpack_require__(17));var _eui=__webpack_require__(13);var _react=__webpack_require__(27);var _react2=_interopRequireWildcard(__webpack_require__(5));var _public=__webpack_require__(24);function _getRequireWildcardCache(nodeInterop){if(typeof WeakMap!=="function")return null;var cacheBabelInterop=new WeakMap;var cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function _getRequireWildcardCache(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(key!=="default"&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function QueryLanguageSwitcher(props){var _useOpenSearchDashboa;var osdDQLDocs=(_useOpenSearchDashboa=(0,_public.useOpenSearchDashboards)().services.docLinks)===null||_useOpenSearchDashboa===void 0?void 0:_useOpenSearchDashboa.links.opensearchDashboards.dql.base;var _useState=(0,_react2.useState)(false),_useState2=(0,_slicedToArray2.default)(_useState,2),isPopoverOpen=_useState2[0],setIsPopoverOpen=_useState2[1];var luceneLabel=_react2.default.createElement(_react.FormattedMessage,{id:"data.query.queryBar.luceneLanguageName",defaultMessage:"Lucene"});var dqlLabel=_react2.default.createElement(_react.FormattedMessage,{id:"data.query.queryBar.dqlLanguageName",defaultMessage:"DQL"});var dqlFullName=_react2.default.createElement(_react.FormattedMessage,{id:"data.query.queryBar.dqlFullLanguageName",defaultMessage:"OpenSearch Dashboards Query Language"});var button=_react2.default.createElement(_eui.EuiButtonEmpty,{size:"xs",onClick:function onClick(){return setIsPopoverOpen(!isPopoverOpen)},className:"euiFormControlLayout__append dqlQueryBar__languageSwitcherButton","data-test-subj":"switchQueryLanguageButton"},props.language==="lucene"?luceneLabel:dqlLabel);return _react2.default.createElement(_eui.EuiPopover,{id:"queryLanguageSwitcherPopover",anchorClassName:"euiFormControlLayout__append",ownFocus:true,anchorPosition:props.anchorPosition||"downRight",button:button,isOpen:isPopoverOpen,closePopover:function closePopover(){return setIsPopoverOpen(false)},repositionOnScroll:true},_react2.default.createElement(_eui.EuiPopoverTitle,null,_react2.default.createElement(_react.FormattedMessage,{id:"data.query.queryBar.syntaxOptionsTitle",defaultMessage:"Syntax options"})),_react2.default.createElement("div",{style:{width:"350px"}},_react2.default.createElement(_eui.EuiText,null,_react2.default.createElement("p",null,_react2.default.createElement(_react.FormattedMessage,{id:"data.query.queryBar.syntaxOptionsDescription",defaultMessage:"The {docsLink} (DQL) offers a simplified query syntax and support for scripted fields. If you turn off DQL, OpenSearch Dashboards uses Lucene.",values:{docsLink:_react2.default.createElement(_eui.EuiLink,{href:osdDQLDocs,target:"_blank"},dqlFullName)}}))),_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_eui.EuiForm,null,_react2.default.createElement(_eui.EuiFormRow,{label:dqlFullName},_react2.default.createElement(_eui.EuiSwitch,{id:"queryEnhancementOptIn",name:"popswitch",label:props.language==="kuery"?_react2.default.createElement(_react.FormattedMessage,{id:"data.query.queryBar.dqlOnLabel",defaultMessage:"On"}):_react2.default.createElement(_react.FormattedMessage,{id:"data.query.queryBar.dqlOffLabel",defaultMessage:"Off"}),checked:props.language==="kuery",onChange:function onChange(){var newLanguage=props.language==="lucene"?"kuery":"lucene";props.onSelectLanguage(newLanguage)},"data-test-subj":"languageToggle"})))))}}}]);
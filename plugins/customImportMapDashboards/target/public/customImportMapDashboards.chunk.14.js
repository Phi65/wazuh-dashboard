(window["customImportMapDashboards_bundle_jsonpfunction"]=window["customImportMapDashboards_bundle_jsonpfunction"]||[]).push([[14],{1072:function(module,exports,__webpack_require__){"use strict";var _interopRequireDefault=__webpack_require__(0);var _typeof=__webpack_require__(8);Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _extends2=_interopRequireDefault(__webpack_require__(32));var _objectWithoutProperties2=_interopRequireDefault(__webpack_require__(20));var _regenerator=_interopRequireDefault(__webpack_require__(14));var _classCallCheck2=_interopRequireDefault(__webpack_require__(3));var _createClass2=_interopRequireDefault(__webpack_require__(4));var _assertThisInitialized2=_interopRequireDefault(__webpack_require__(16));var _inherits2=_interopRequireDefault(__webpack_require__(11));var _possibleConstructorReturn2=_interopRequireDefault(__webpack_require__(12));var _getPrototypeOf2=_interopRequireDefault(__webpack_require__(9));var _defineProperty2=_interopRequireDefault(__webpack_require__(1));var _asyncToGenerator2=_interopRequireDefault(__webpack_require__(15));var _lodash=_interopRequireDefault(__webpack_require__(7));var _react=_interopRequireWildcard(__webpack_require__(5));var _eui=__webpack_require__(13);var _lib=__webpack_require__(89);var _excluded=["fieldTypes","onChange","indexPatternId","placeholder","onNoIndexPatterns","savedObjectsClient"];function _getRequireWildcardCache(nodeInterop){if(typeof WeakMap!=="function")return null;var cacheBabelInterop=new WeakMap;var cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function _getRequireWildcardCache(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(key!=="default"&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=(0,_getPrototypeOf2.default)(Derived),result;if(hasNativeReflectConstruct){var NewTarget=(0,_getPrototypeOf2.default)(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return(0,_possibleConstructorReturn2.default)(this,result)}}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));return true}catch(e){return false}}var getIndexPatterns=function(){var _ref=(0,_asyncToGenerator2.default)(_regenerator.default.mark((function _callee(client,search,fields){var resp;return _regenerator.default.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return client.find({type:"index-pattern",fields:fields,search:"".concat(search,"*"),searchFields:["title"],perPage:100});case 2:resp=_context.sent;return _context.abrupt("return",resp.savedObjects);case 4:case"end":return _context.stop()}}}),_callee)})));return function getIndexPatterns(_x,_x2,_x3){return _ref.apply(this,arguments)}}();var IndexPatternSelect=function(_Component){(0,_inherits2.default)(IndexPatternSelect,_Component);var _super=_createSuper(IndexPatternSelect);function IndexPatternSelect(props){var _this;(0,_classCallCheck2.default)(this,IndexPatternSelect);_this=_super.call(this,props);(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"isMounted",false);(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"state",void 0);(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"fetchSelectedIndexPattern",function(){var _ref2=(0,_asyncToGenerator2.default)(_regenerator.default.mark((function _callee2(indexPatternId){var indexPatternTitle;return _regenerator.default.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(indexPatternId){_context2.next=3;break}_this.setState({selectedIndexPattern:undefined});return _context2.abrupt("return");case 3:_context2.prev=3;_context2.next=6;return(0,_lib.getTitle)(_this.props.savedObjectsClient,indexPatternId);case 6:indexPatternTitle=_context2.sent;_context2.next=12;break;case 9:_context2.prev=9;_context2.t0=_context2["catch"](3);return _context2.abrupt("return");case 12:if(_this.isMounted){_context2.next=14;break}return _context2.abrupt("return");case 14:_this.setState({selectedIndexPattern:{value:indexPatternId,label:indexPatternTitle}});case 15:case"end":return _context2.stop()}}}),_callee2,null,[[3,9]])})));return function(_x4){return _ref2.apply(this,arguments)}}());(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"debouncedFetch",_lodash.default.debounce(function(){var _ref3=(0,_asyncToGenerator2.default)(_regenerator.default.mark((function _callee3(searchValue){var _this$props,fieldTypes,onNoIndexPatterns,savedObjectsClient,savedObjectFields,savedObjects,options;return _regenerator.default.wrap((function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_this$props=_this.props,fieldTypes=_this$props.fieldTypes,onNoIndexPatterns=_this$props.onNoIndexPatterns,savedObjectsClient=_this$props.savedObjectsClient;savedObjectFields=["title"];if(fieldTypes){savedObjectFields.push("fields")}_context3.next=5;return getIndexPatterns(savedObjectsClient,searchValue,savedObjectFields);case 5:savedObjects=_context3.sent;if(fieldTypes){savedObjects=savedObjects.filter((function(savedObject){try{var indexPatternFields=JSON.parse(savedObject.attributes.fields);return indexPatternFields.some((function(field){return fieldTypes===null||fieldTypes===void 0?void 0:fieldTypes.includes(field.type)}))}catch(err){return false}}))}if(_this.isMounted){_context3.next=9;break}return _context3.abrupt("return");case 9:if(searchValue===_this.state.searchValue){options=savedObjects.map((function(indexPatternSavedObject){return{label:indexPatternSavedObject.attributes.title,value:indexPatternSavedObject.id}}));_this.setState({isLoading:false,options:options});if(onNoIndexPatterns&&searchValue===""&&options.length===0){onNoIndexPatterns()}}case 10:case"end":return _context3.stop()}}}),_callee3)})));return function(_x5){return _ref3.apply(this,arguments)}}(),300));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"fetchOptions",(function(){var searchValue=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";_this.setState({isLoading:true,searchValue:searchValue},_this.debouncedFetch.bind(null,searchValue))}));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"onChange",(function(selectedOptions){_this.props.onChange(_lodash.default.get(selectedOptions,"0.value"))}));_this.state={isLoading:false,options:[],selectedIndexPattern:undefined,searchValue:undefined};return _this}(0,_createClass2.default)(IndexPatternSelect,[{key:"componentWillUnmount",value:function componentWillUnmount(){this.isMounted=false;this.debouncedFetch.cancel()}},{key:"componentDidMount",value:function componentDidMount(){this.isMounted=true;this.fetchOptions();this.fetchSelectedIndexPattern(this.props.indexPatternId)}},{key:"UNSAFE_componentWillReceiveProps",value:function UNSAFE_componentWillReceiveProps(nextProps){if(nextProps.indexPatternId!==this.props.indexPatternId){this.fetchSelectedIndexPattern(nextProps.indexPatternId)}}},{key:"render",value:function render(){var _this$props2=this.props,fieldTypes=_this$props2.fieldTypes,onChange=_this$props2.onChange,indexPatternId=_this$props2.indexPatternId,placeholder=_this$props2.placeholder,onNoIndexPatterns=_this$props2.onNoIndexPatterns,savedObjectsClient=_this$props2.savedObjectsClient,rest=(0,_objectWithoutProperties2.default)(_this$props2,_excluded);return _react.default.createElement(_eui.EuiComboBox,(0,_extends2.default)({},rest,{placeholder:placeholder,singleSelection:true,isLoading:this.state.isLoading,onSearchChange:this.fetchOptions,options:this.state.options,selectedOptions:this.state.selectedIndexPattern?[this.state.selectedIndexPattern]:[],onChange:this.onChange}))}}]);return IndexPatternSelect}(_react.Component);exports.default=IndexPatternSelect;module.exports=exports.default}}]);
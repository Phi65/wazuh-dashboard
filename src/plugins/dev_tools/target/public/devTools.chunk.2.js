(window["devTools_bundle_jsonpfunction"]=window["devTools_bundle_jsonpfunction"]||[]).push([[2],{155:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"renderApp",(function(){return renderApp}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(18);var react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);var react_dom__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(20);var react_dom__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react_dom__WEBPACK_IMPORTED_MODULE_1__);var react_router_dom__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(21);var react_router_dom__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(react_router_dom__WEBPACK_IMPORTED_MODULE_2__);var _elastic_eui__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(22);var _elastic_eui__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_elastic_eui__WEBPACK_IMPORTED_MODULE_3__);var _osd_i18n_react__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(23);var _osd_i18n_react__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_osd_i18n_react__WEBPACK_IMPORTED_MODULE_4__);var _osd_i18n__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(3);var _osd_i18n__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_osd_i18n__WEBPACK_IMPORTED_MODULE_5__);var react_use__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(52);var react_use__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(react_use__WEBPACK_IMPORTED_MODULE_6__);var _data_source_management_public_components_utils__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(24);var _data_source_management_public_components_utils__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(_data_source_management_public_components_utils__WEBPACK_IMPORTED_MODULE_7__);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _iterableToArrayLimit(arr,i){var _i=arr==null?null:typeof Symbol!=="undefined"&&arr[Symbol.iterator]||arr["@@iterator"];if(_i==null)return;var _arr=[];var _n=true;var _d=false;var _s,_e;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function DevToolsWrapper(_ref){var devTools=_ref.devTools,activeDevTool=_ref.activeDevTool,updateRoute=_ref.updateRoute,savedObjects=_ref.savedObjects,toasts=_ref.notifications.toasts,dataSourceEnabled=_ref.dataSourceEnabled;var mountedTool=Object(react__WEBPACK_IMPORTED_MODULE_0__["useRef"])(null);var _useState=Object(react__WEBPACK_IMPORTED_MODULE_0__["useState"])([]),_useState2=_slicedToArray(_useState,2),dataSources=_useState2[0],setDataSources=_useState2[1];var _useState3=Object(react__WEBPACK_IMPORTED_MODULE_0__["useState"])([]),_useState4=_slicedToArray(_useState3,2),selectedOptions=_useState4[0],setSelectedOptions=_useState4[1];Object(react__WEBPACK_IMPORTED_MODULE_0__["useEffect"])((function(){return function(){if(mountedTool.current){mountedTool.current.unmountHandler()}}}),[]);Object(react_use__WEBPACK_IMPORTED_MODULE_6__["useEffectOnce"])((function(){fetchDataSources()}));var fetchDataSources=function fetchDataSources(){Object(_data_source_management_public_components_utils__WEBPACK_IMPORTED_MODULE_7__["getDataSources"])(savedObjects.client).then((function(fetchedDataSources){if(fetchedDataSources!==null&&fetchedDataSources!==void 0&&fetchedDataSources.length){var dataSourceOptions=fetchedDataSources.map((function(dataSource){return{id:dataSource.id,label:dataSource.title}}));setDataSources(dataSourceOptions)}})).catch((function(){toasts.addDanger(_osd_i18n__WEBPACK_IMPORTED_MODULE_5__["i18n"].translate("devTool.devToolWrapper.fetchDataSourceError",{defaultMessage:"Unable to fetch existing data sources"}))}))};var onChange=function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee(e){var dataSourceId;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dataSourceId=e[0]?e[0].id:undefined;setSelectedOptions(e);_context.next=4;return remount(mountedTool.current.mountpoint,dataSourceId);case 4:case"end":return _context.stop()}}}),_callee)})));return function onChange(_x){return _ref2.apply(this,arguments)}}();var remount=function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(mountPoint,dataSourceId){var params,unmountHandler;return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(mountedTool.current){mountedTool.current.unmountHandler()}params={element:mountPoint,appBasePath:"",onAppLeave:function onAppLeave(){return undefined},setHeaderActionMenu:function setHeaderActionMenu(){return undefined},history:{},dataSourceId:dataSourceId};_context2.next=4;return activeDevTool.mount(params);case 4:unmountHandler=_context2.sent;mountedTool.current={devTool:activeDevTool,mountpoint:mountPoint,unmountHandler:unmountHandler};case 6:case"end":return _context2.stop()}}}),_callee2)})));return function remount(_x2,_x3){return _ref3.apply(this,arguments)}}();return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("main",{className:"devApp"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_3__["EuiTabs"],{className:"devAppTabs"},devTools.map((function(currentDevTool){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_3__["EuiToolTip"],{content:currentDevTool.tooltipContent,key:currentDevTool.id},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_3__["EuiTab"],{disabled:currentDevTool.isDisabled(),isSelected:currentDevTool===activeDevTool,onClick:function onClick(){if(!currentDevTool.isDisabled()){updateRoute("/".concat(currentDevTool.id))}}},currentDevTool.title))})),dataSourceEnabled?react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"devAppDataSourcePicker"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_3__["EuiComboBox"],{"aria-label":_osd_i18n__WEBPACK_IMPORTED_MODULE_5__["i18n"].translate("devTool.devToolWrapper.DataSourceComboBoxAriaLabel",{defaultMessage:"Select a Data Source"}),placeholder:_osd_i18n__WEBPACK_IMPORTED_MODULE_5__["i18n"].translate("devTool.devToolWrapper.DataSourceComboBoxPlaceholder",{defaultMessage:"Select a Data Source"}),singleSelection:{asPlainText:true},options:dataSources,selectedOptions:selectedOptions,onChange:onChange,prepend:"DataSource",compressed:true,isDisabled:!dataSourceEnabled})):null),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"devApp__container",role:"tabpanel","data-test-subj":activeDevTool.id,ref:function(){var _ref4=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(element){return regeneratorRuntime.wrap((function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!(element&&(mountedTool.current===null||mountedTool.current.devTool!==activeDevTool||mountedTool.current.mountpoint!==element))){_context3.next=3;break}_context3.next=3;return remount(element);case 3:case"end":return _context3.stop()}}}),_callee3)})));return function(_x4){return _ref4.apply(this,arguments)}}()}))}function redirectOnMissingCapabilities(application){if(!application.capabilities.dev_tools.show){application.navigateToApp("home");return true}return false}function setBadge(application,chrome){if(application.capabilities.dev_tools.save){return}chrome.setBadge({text:_osd_i18n__WEBPACK_IMPORTED_MODULE_5__["i18n"].translate("devTools.badge.readOnly.text",{defaultMessage:"Read only"}),tooltip:_osd_i18n__WEBPACK_IMPORTED_MODULE_5__["i18n"].translate("devTools.badge.readOnly.tooltip",{defaultMessage:"Unable to save"}),iconType:"glasses"})}function setTitle(chrome){chrome.docTitle.change(_osd_i18n__WEBPACK_IMPORTED_MODULE_5__["i18n"].translate("devTools.pageTitle",{defaultMessage:"Dev Tools"}))}function setBreadcrumbs(chrome){chrome.setBreadcrumbs([{text:_osd_i18n__WEBPACK_IMPORTED_MODULE_5__["i18n"].translate("devTools.k7BreadcrumbsDevToolsLabel",{defaultMessage:"Dev Tools"}),href:"#/"}])}function renderApp(_ref5,element,history,devTools,_ref6){var application=_ref5.application,chrome=_ref5.chrome,savedObjects=_ref5.savedObjects,notifications=_ref5.notifications;var dataSource=_ref6.dataSource;var dataSourceEnabled=!!dataSource;if(redirectOnMissingCapabilities(application)){return function(){}}setBadge(application,chrome);setBreadcrumbs(chrome);setTitle(chrome);react_dom__WEBPACK_IMPORTED_MODULE_1___default.a.render(react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_osd_i18n_react__WEBPACK_IMPORTED_MODULE_4__["I18nProvider"],null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_2__["HashRouter"],null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_2__["Switch"],null,devTools.filter((function(devTool){return!devTool.isDisabled()})).map((function(devTool){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_2__["Route"],{key:devTool.id,path:"/".concat(devTool.id),exact:!devTool.enableRouting,render:function render(props){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(DevToolsWrapper,{updateRoute:props.history.push,activeDevTool:devTool,devTools:devTools,savedObjects:savedObjects,notifications:notifications,dataSourceEnabled:dataSourceEnabled})}})})),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_2__["Route"],{path:"/"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_2__["Redirect"],{to:"/".concat(devTools[0].id)}))))),element);var unlisten=history.listen((function(){window.dispatchEvent(new HashChangeEvent("hashchange"))}));return function(){chrome.docTitle.reset();react_dom__WEBPACK_IMPORTED_MODULE_1___default.a.unmountComponentAtNode(element);unlisten()}}}}]);